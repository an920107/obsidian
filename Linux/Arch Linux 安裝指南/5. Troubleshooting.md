## 5.1 安裝 Nvidia 專屬驅動

### 5.1.1 Unable to find the kernel source tree

先將 pacman 更新，再安裝 pacman 套件 `linux-headers`

```bash
sudo pacman -Syu
sudo pacman -S linux-headers
```

### 5.1.2 啟用 Wayland 而非 Xorg

> Nvidia 很爛，裝了 NV 驅動後會自動禁用 Wayland

1. 編輯 `/etc/gdm/custom.conf`，將 `WaylandEnable` 設為 `true`

2. 編輯 `/etc/mkinitcpio.conf`，在 `MODULES` 中新增 `nvidia nvidia_modeset nvidia_uvm nvidia_drm`，以正確載入 Nvidia 驅動，接著執行以下指令使其生效
   
   ```bash
   sudo mkinitcpio -P
   ```

3. 編輯 `/etc/default/grub`，在 `GRUB_CMDLINE_LINUX_DEFAULT` 中新增 `nvidia-drm.modeset=1` 參數，並執行以下指令更新 grub
   
   ```bash
   sudo update-grup
   ```

### 5.1.3 OBS 無法在 Wayland 開啟

安裝 qt 相關套件

```bash
sudo pacman -S qt6-wayland qt5-wayland
```



## 5.2 睡眠後 wifi 無法使用

1. 新增 service 設定檔 `/etc/systemd/system/network-resume.service`
   
   ```systemd
   [Unit]
   Description=Reload wifi driver on system resume
   After=suspend.target
   
   [Service]
   Type=oneshot
   ExecStart=/usr/bin/modprobe -r iwlmvm
   ExecStart=/usr/bin/modprobe iwlwifi 
   
   [Install]
   WantedBy=suspend.target
   ```

2. 啟用自定義服務
   
   ```bash
   sudo systemctl enable network-resume.service
   ```
